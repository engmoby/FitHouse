<script type="text/javascript">
    $(document).ready(function () {
        $(".select-add-tags").select2({
            tags: true,
            theme: "bootstrap",
            insertTag: function (data, tag) {
                // Insert the tag at the end of the results
                data.push(tag);
                // console.log(data);
            }
        });

        $(".select-tags").select2({
            tags: false,
            theme: "bootstrap",
        });

        $(".select-with-search").select2({
            theme: "bootstrap"
        });
    });

    $(function () {
        var today = new Date();
        var tomorrow = new Date();
        $('#startdate').datetimepicker(
            {
                minDate: tomorrow.setDate(today.getDate() + 1)
            }
        ).on('dp.change', function (e) {
            debugger;
            angular.element(document.getElementById('startdate')).scope().dateChange();
        });
    });
</script>
<form class="form-horizontal" name="newProgram3Form">

    <br>

    <div class="row">
        <div
            class="col-md-4 form-group pmd-textfield pmd-textfield-floating-label pmd-textfield-floating-label-completed">
            <label for="regular1" class="control-label">{{'orderPickDateTime' | translate}}</label>
            <div class="form-group pmd-textfield pmd-textfield-floating-label">
                <input ng-model="orderCustomizeProgramCtrl.itemDatetime" type="text"
                    ng-change="orderCustomizeProgramCtrl.dateChange()" id="startdate" class="form-control" />
            </div>
        </div>
    </div>


    <div class="row">
        <div class="col-md-3">
            <label for="first-name">{{'OrderType' | translate}}</label>
        </div>
    </div>

    <div class="row">
        <div class="col-md-3">
            <div class="form-group pmd-textfield pmd-textfield-floating-label pmd-textfield-floating-label-completed">
                <label>
                    <input type="radio" ng-model="orderCustomizeProgramCtrl.orderType.type"
                        ng-change="orderCustomizeProgramCtrl.typeChanged()" value="delivery">
                    {{'Deivery' | translate}}
                </label>
                <label style="margin-left:3em">
                    <input type="radio" ng-model="orderCustomizeProgramCtrl.orderType.type"
                        ng-change="orderCustomizeProgramCtrl.typeChanged()" value="pickup">
                    {{'Pickup' | translate}}
                </label>
                <br />
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-md-6">
            <!-- {{orderCustomizeProgramCtrl.userAddresses.length}} -->
            <div ng-if="orderCustomizeProgramCtrl.orderType.type == 'delivery'">
                <div
                    class="form-group pmd-textfield pmd-textfield-floating-label pmd-textfield-floating-label-completed">
                    <label for="first-name">{{'SelectAddress' | translate}}</label>

                    <div ng-repeat="address in orderCustomizeProgramCtrl.userAddresses">
                        <!-- {{orderCustomizeProgramCtrl.addresses.address}} -->
                        <label>
                            <input ng-change="orderCustomizeProgramCtrl.addressInfo(address)" type="radio"
                                ng-model="orderCustomizeProgramCtrl.addresses.address" value="{{address.addressId}}">
                            {{'appartmentNo' | translate}}: {{address.appartmentNo}}
                            <br> {{'FLoor' | translate}} : {{address.floor}}
                            <br> {{'description' | translate}}
                            :{{address.description}}</label>
                        </label>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-md-6">
            <div ng-show="orderCustomizeProgramCtrl.orderType.type == 'pickup'">
                <div
                    class="form-group pmd-textfield pmd-textfield-floating-label pmd-textfield-floating-label-completed">
                    <label for="first-name">{{'Country' | translate}}</label>
                    <select required style="width:100% !important" class="select-tags form-control pmd-select2-tags"
                        ng-change="orderCustomizeProgramCtrl.countryChange()"
                        ng-model="orderCustomizeProgramCtrl.selectedCountryId"
                        ng-options="group.countryId as group.titleDictionary[selectedLanguage] for group in orderCustomizeProgramCtrl.counties">
                    </select>
                </div>
                <div ng-show=" orderCustomizeProgramCtrl.selectedCountryId > 0"
                    class="form-group pmd-textfield pmd-textfield-floating-label pmd-textfield-floating-label-completed">
                    <label for="first-name">{{'Region' | translate}}</label>
                    <select required style="width:100% !important" class="select-tags form-control pmd-select2-tags"
                        ng-change="orderCustomizeProgramCtrl.regionChange()"
                        ng-model="orderCustomizeProgramCtrl.selectedRegionId"
                        ng-options="group.regionId as group.titleDictionary[selectedLanguage] for group in orderCustomizeProgramCtrl.regions">
                    </select>
                </div>
                <div ng-show=" orderCustomizeProgramCtrl.selectedRegionId > 0"
                    class="form-group pmd-textfield pmd-textfield-floating-label pmd-textfield-floating-label-completed">
                    <label for="first-name">{{'City' | translate}}</label>
                    <select ng-required="orderCustomizeProgramCtrl.selectedRegionId > 0" style="width:100% !important"
                        class="select-tags form-control pmd-select2-tags"
                        ng-change="orderCustomizeProgramCtrl.cityChange()"
                        ng-model="orderCustomizeProgramCtrl.selectedCityId"
                        ng-options="group.cityId as group.titleDictionary[selectedLanguage] for group in orderCustomizeProgramCtrl.cities">
                    </select>
                </div>
                <div ng-show=" orderCustomizeProgramCtrl.selectedCityId > 0"
                    class="form-group pmd-textfield pmd-textfield-floating-label pmd-textfield-floating-label-completed">
                    <label for="first-name">{{'Area' | translate}}</label>
                    <select ng-required=" orderCustomizeProgramCtrl.selectedCityId > 0" style="width:100% !important"
                        class="select-tags form-control pmd-select2-tags"
                        ng-change="orderCustomizeProgramCtrl.areaChange()"
                        ng-model="orderCustomizeProgramCtrl.selectedAreaId"
                        ng-options="group.areaId as group.titleDictionary[selectedLanguage] for group in orderCustomizeProgramCtrl.area">
                    </select>
                </div>
                <div ng-show=" orderCustomizeProgramCtrl.selectedAreaId > 0"
                    class="form-group pmd-textfield pmd-textfield-floating-label pmd-textfield-floating-label-completed">
                    <label for="first-name">{{'Branch' | translate}}</label>
                    <select ng-required=" orderCustomizeProgramCtrl.selectedAreaId > 0 "
                        class="form-control select-with-search pmd-select2-tags"
                        ng-change="orderCustomizeProgramCtrl.branchChange()"
                        ng-model="orderCustomizeProgramCtrl.selectedBranchId"
                        ng-options="a.branchId as a.titleDictionary[selectedLanguage] for a in orderCustomizeProgramCtrl.branchList"></select>
                </div>

            </div>
        </div>
    </div>
    
    <div class="row">
        <div class="input-field col s2">
            <input required type="text" class="mat-input" name="title"
                placeholder="{{'PromotionLbl' | translate}}" ng-model="Title" minlength="3" maxlength="255">
            <div ng-messages="newProgram3Form.title.$error">
                <div ng-show="newProgram3Form.title.$error.required && !newProgram3Form.title.$pristine">
                    {{'requiredErr' | translate}}</div>
                <div
                    ng-show="(newProgram3Form.title.$error.minlength || newProgram3Form.title.$error.maxlength) && !newProgram3Form.title.$error.required">
                    {{'NameLengthError255' | translate}}</div>
            </div>
        </div>

        <div class="input-field col s2">
            <button style="background-color: #e4e5e6;color: black!important;"
                class="btn pmd-ripple-effect btn-primary" ng-click="checkPromotion(Title)"
                ng-disabled="orderCustomizeProgramCtrl.itemList.length <= 0 ||!btnCheckValid|| Title==null ">
                {{'CheckPromotion' | translate}}</button>

        </div>
        <br>

    </div>

    <span class="input-field col s6" ng-show="promotionValue == null">
        {{ promotionError}}</span>

    <!-- <span class="input-field col s6" ng-show="promotionError== null">
        {{'value' | translate}}: {{ promotionValue.value}}
    </span> -->
   
    {{'Pricelbl' | translate}}:{{orderCustomizeProgramCtrl.totalPrice | number:2}} SR
    <!-- {{'Pricelbl' | translate}}:{{orderCustomizeProgramCtrl.totalPrice | number:0}} SR  -->
    <br>{{'ProgramDiscount' | translate}} : {{ orderCustomizeProgramCtrl.ProgramDiscount}} %
    <br> {{'DeliveryPrice' | translate}}:{{ orderCustomizeProgramCtrl.DeliveryFees}} SR
    <br>{{'Total' | translate}} :{{ orderCustomizeProgramCtrl.Total| number:2}} SR
    <br>

    <div class="pmd-modal-action text-right">

        <button style="background-color: #e4e5e6;color: black!important;" class="btn pmd-ripple-effect btn-primary"
            type="button" ng-click="$state.go('callCenter');">{{'PreviousStep' | translate}}</button>

        <button style="background-color: #e4e5e6;color: black!important;"
            ng-disabled="orderCustomizeProgramCtrl.selectedBranchId  <= 0 || !orderCustomizeProgramCtrl.dateIsValid"
            class="btn btn-success" name="next" type="button" ng-click="orderCustomizeProgramCtrl.AddNewProgram()">
            {{'Save' | translate}}</button>

        <!-- ng-disabled="(orderCustomizeProgramCtrl.currentStep != orderCustomizeProgramCtrl.steps.length)||
        !orderCustomizeProgramCtrl.dateIsValid"  -->
    </div>
</form>